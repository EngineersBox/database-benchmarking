services:
  hbase:
    container_name: hbase
    image: ghcr.io/engineersbox/hbase:2.6.3
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /var/lib/cluster/logs:/var/lib/hbase/logs
      - /var/lib/cluster/config/hbase:/var/lib/hbase/conf
      # HDFS
      - /var/lib/hadoop:/var/lib/hadoop
    mem_limit: 16gb
    memswap_limit: 16gb
    mem_swappiness: 0
    ports:
      - 16000:16000
      - 16010:16010 
      - 16020:16020
      - 16030:16030
      - 8080:8080
      - 8085:8085
      - 9090:9090
      - 9095:9095
    env_file:
      - path: /var/lib/cluster/node_env
        required: true
    network_mode: host
  otel-hostmetrics:
    container_name: otel-hostmetrics
    image: otel/opentelemetry-collector-contrib:0.101.0
    volumes:
      - "/var/log/otel_hostmetrics:/var/log/otel"
      - "/var/lib/cluster/config/otel/otel-instance-config.yaml:/etc/otelcol-contrib/config.yaml"
      - /var/run/docker.sock:/var/run/docker.sock 
      - /sys/fs/cgroup:/hostfs/sys/fs/cgroup 
      - /etc:/hostfs/etc 
      - /etc:/etc
      - /var/cache:/hostfs/cache 
      - /usr/src:/hostfs/usr/src 
      - /lib/modules:/hostfs/lib/modules 
      - /boot:/boot
      - /snap:/snap
      - /:/hostfs
      - /proc:/hostfs/proc
    env_file:
      - path: /var/lib/cluster/node_env
        required: true
    network_mode: host
    pid: host
    privileged: true
  otel-kernel:
    container_name: otel-kernel
    image: otel/opentelemetry-ebpf-kernel-collector:v0.10.2
    command: ["--log-console"]
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock 
      - /sys/fs/cgroup:/hostfs/sys/fs/cgroup 
      - /etc:/hostfs/etc 
      - /var/cache:/hostfs/cache 
      - /usr/src:/hostfs/usr/src 
      - /lib/modules:/hostfs/lib/modules 
    env_file:
      - path: /var/lib/cluster/node_env
        required: true
    network_mode: host
    pid: host
    privileged: true
